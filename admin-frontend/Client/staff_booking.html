<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giao di·ªán Nh√¢n vi√™n - ƒê·∫∑t S√¢n</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./css/style_staff.css">
</head>

<body>
    <div class="staff-wrapper">

        <!-- ====================== HEADER ======================= -->
        <header class="staff-header">
            <div class="header-left">
                <h2 id="main-title"> Qu·∫£n l√Ω ƒê·∫∑t S√¢n</h2>
            </div>
            <nav class="staff-nav">
                <a id="nav-booking" class="nav-item active" data-content="booking-content">ƒê·∫∑t S√¢n</a>
            </nav>
            <div class="profile-info">
                <span class="user-name" id="userName"></span>
                <span class="logout-btn" id="logoutBtn">ƒêƒÉng xu·∫•t</span>
            </div>
        </header>

        <!-- ====================== MAIN CONTENT ======================= -->
        <div class="main-content-staff">

            <!-- ====================== TAB: ƒê·∫∂T S√ÇN ======================= -->
            <div id="booking-content">
                <div class="controls-bar">
                    <div class="filter-group">
                        <label for="date-select">Ng√†y:</label>
                        <input type="date" id="date-select" value="2025-11-25">
                    </div>

                    <div class="filter-group">
                        <label for="field-filter">S√¢n:</label>
                        <select id="field-filter">
                            <option value="all">T·∫•t c·∫£</option>
                        </select>
                    </div>
                    <button class="btn-primary create-btn"> T·∫°o ƒê∆°n M·ªõi</button>
                    <button id="btnQrCheckin" class="btn qr">
                        üì∑ Check-in QR
                    </button>
                </div>

                <section id="allVenuesContainer">
                    <!-- JS s·∫Ω t·ª± t·∫°o t·ª´ng b·∫£ng theo t·ª´ng khu -->
                </section>

            </div>

            <!-- ========================= EDIT BOOKING MODAL ========================= -->
            <div id="editBookingModal" class="modal-overlay" style="display: none;">
                <div class="modal-content card">
                    <h3> Chi ti·∫øt ƒê∆°n ƒê·∫∑t S√¢n</h3>

                    <div class="form-section">
                        <h4>Th√¥ng tin C∆° b·∫£n</h4>
                        <div class="form-row">
                            <div type="hidden" class="form-group half-width">
                                <label>M√£ ƒë∆°n:</label>
                                <input type="text" id="edit-booking-id" readonly>
                            </div>
                            <div class="form-group half-width">
                                <label>Kh√°ch h√†ng:</label>
                                <input type="text" id="edit-customer-name">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group half-width">
                                <label>S·ªë ƒëi·ªán tho·∫°i:</label>
                                <input type="text" id="edit-phone">
                            </div>
                            <div class="form-group half-width">
                                <label>Ng√†y:</label>
                                <input type="date" id="edit-date">
                            </div>
                            <div class="form-group half-width">
                                <label for="edit-Khu">Khu:</label>
                                <select id="edit-Khu"></select>
                            </div>
                            <div class="form-group half-width">
                                <label for="edit-field">S√¢n:</label>
                                <select id="edit-field"></select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group half-width">
                                <label>B·∫Øt ƒë·∫ßu:</label>
                                <input type="time" id="edit-start-time" min="00:00" max="23:59" step="60">
                            </div>
                            <div class="form-group half-width">
                                <label>K·∫øt th√∫c:</label>
                                <input type="time" id="edit-end-time" min="00:00" max="23:59" step="60">
                            </div>
                        </div>
                        <button class="btn-dichvu-edit" id="addServiceEditBtn">+ Th√™m d·ªãch v·ª•</button>
                    </div>
                    <!-- D·ªãch v·ª• -->
                    <div class="form-section">
                        <h4>D·ªãch v·ª•</h4>
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>T√™n d·ªãch v·ª•</th>
                                    <th width="120">S·ªë l∆∞·ª£ng</th>
                                    <th width="120">Gi√°</th>
                                    <th width="80"></th>
                                </tr>
                            </thead>
                            <tbody id="serviceTableBodyEdit">
                                <!-- JS render -->
                            </tbody>
                        </table>
                    </div>
                    <div class="form-section">
                        <h4>Thanh to√°n</h4>
                        <div class="form-row">
                            <div class="form-group half-width">
                                <label>Gi√° s√¢n (VNƒê):</label>
                                <input type="number" id="edit-price" readonly>
                            </div>
                            <div class="form-group half-width">
                                <label>Gi√° d·ªãch v·ª• (VNƒê):</label>
                                <input type="number" id="edit-price-DV" readonly>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button class="btn-secondary" id="deleteBookingBtn"> X√≥a</button>
                        <button class="btn-primary" id="saveBookingBtn">L∆∞u</button>
                        <button class="btn-primary" id="checkInBtn" style="background:#FF9800">‚úîÔ∏è Check-in</button>
                        <button class="btn-secondary" id="closeEditModalBtn">ƒê√≥ng</button>
                    </div>
                </div>
            </div>

            <!-- ========================= NEW BOOKING MODAL ========================= -->
            <div id="newBookingModal" class="modal-overlay" style="display: none;">
                <div class="modal-content card">
                    <h3>‚ú® T·∫°o ƒê∆°n ƒê·∫∑t S√¢n M·ªõi</h3>

                    <!-- TH√îNG TIN KH√ÅCH -->
                    <div class="form-section">
                        <h4>Th√¥ng tin Kh√°ch</h4>
                        <div class="form-group">
                            <label for="new-customer-name">T√™n kh√°ch h√†ng <span class="required">*</span></label>
                            <input type="text" id="new-customer-name">
                        </div>
                        <div class="form-group">
                            <label for="new-phone">S·ªë ƒëi·ªán tho·∫°i <span class="required">*</span></label>
                            <input type="tel" id="new-phone" placeholder="V√≠ d·ª•: 090xxxxxxx">
                        </div>
                    </div>

                    <!-- TH·ªúI GIAN & S√ÇN -->
                    <div class="form-section">
                        <h4>Th·ªùi gian & S√¢n</h4>

                        <div class="form-row">
                            <div class="form-group half-width">
                                <label for="new-date">Ng√†y ƒë·∫∑t</label>
                                <input type="date" id="new-date" value="2025-11-25">
                            </div>
                            <div class="form-group half-width">
                                <label for="new-Khu">Khu</label>
                                <select id="new-Khu"></select>
                            </div>
                            <div class="form-group half-width">
                                <label for="new-field">S√¢n</label>
                                <select id="new-field"></select>
                            </div>
                            <div class="form-group half-width">
                                <label for="new-start-time">B·∫Øt ƒë·∫ßu</label>
                                <input type="time" id="new-start-time" lang="en-GB" min="00:00" max="23:59" step="60">

                            </div>
                            <div class="form-group half-width">
                                <label for="new-end-time">K·∫øt th√∫c</label>
                                <input type="time" id="new-end-time" lang="en-GB" min="00:00" max="23:59" step="60">

                            </div>
                            <button class="btn-dichvu" id="submitNewdichvuBooking">+ Th√™m d·ªãch v·ª•</button>
                        </div>
                    </div>
                    <!-- D·ªãch v·ª• -->
                    <div class="form-section">
                        <h4>D·ªãch v·ª•</h4>
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>T√™n d·ªãch v·ª•</th>
                                    <th width="120">S·ªë l∆∞·ª£ng</th>
                                    <th width="120">Gi√°</th>
                                    <th width="80"></th>
                                </tr>
                            </thead>
                            <tbody id="serviceTableBody">
                                <!-- JS render -->
                            </tbody>
                        </table>
                    </div>
                    <!-- T√çNH TO√ÅN & THANH TO√ÅN -->
                    <div class="form-section">
                        <h4>T√≠nh to√°n & Thanh to√°n</h4>
                        <div class="calculation-summary">
                            <p>T·ªïng th·ªùi gian ƒë·∫∑t: <span class="value-display" id="calculated-duration"></span></p>
                            <p>ƒê∆°n gi√°/s√¢n: <span class="value-display" id="price-per-hour"></span></p>
                            <p>D·ªãch v·ª•/s√¢n: <span class="value-display" id="price-dichvu"></span></p>
                            <p>T·ªïng ti·ªÅn: <span class="value-display" id="calculated-total"></span></p>
                        </div>
                    </div>

                    <!-- GHI CH√ö -->
                    <div class="form-section">
                        <h4>Ghi ch√∫</h4>
                        <textarea id="new-notes" rows="2" placeholder="Ghi ch√∫ n·ªôi b·ªô..."></textarea>
                    </div>

                    <!-- ACTION BUTTONS -->
                    <div class="form-actions">
                        <button class="btn-secondary" id="closeNewModalBtn">H·ªßy</button>
                        <button class="btn-primary" id="submitNewBookingBtn">X√°c nh·∫≠n ƒë·∫∑t s√¢n</button>
                    </div>
                </div>
            </div>
            <!-- ================= CHOOSE SERVICE MODAL ================= -->
            <div id="serviceModal" class="modal-overlay" style="display:none;">
                <div class="modal-content card" style="max-width:700px;">
                    <h3>üßæ Ch·ªçn d·ªãch v·ª•</h3>

                    <table class="table table-bordered table-sm">
                        <thead>
                            <tr>
                                <th>T√™n d·ªãch v·ª•</th>
                                <th width="120">Gi√°</th>
                                <th width="120"></th>
                            </tr>
                        </thead>
                        <tbody id="serviceModalBody">
                            <!-- JS render -->
                        </tbody>
                    </table>

                    <div class="form-actions">
                        <button class="btn-secondary" id="closeServiceModalBtn">ƒê√≥ng</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- QR -->
        <div id="qrModal" class="modal-qr">
            <div class="modal-content-pr">
                <h3>Qu√©t QR check-in</h3>
                <div id="qr-reader" style="width:300px;height:300px;margin:auto"></div>
                <button id="closeQrBtn">ƒê√≥ng</button>
            </div>
        </div>

        <!-- Menu logic -->
        <script>
            function showContent(contentId, title) {
                document.getElementById('booking-content').style.display = 'none';

                document.getElementById(contentId).style.display = 'block';
                document.getElementById('main-title').innerText = title;

                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                document.querySelector(`[data-content="${contentId}"]`).classList.add('active');
            }
            document.getElementById('nav-booking').onclick = () =>
                showContent('booking-content', ' Qu·∫£n l√Ω ƒê·∫∑t S√¢n');
        </script>
        <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
        <!-- Supabase SDK -->
        <script src="https://unpkg.com/@supabase/supabase-js@2.39.6/dist/umd/supabase.js"></script>
        <!-- Main JS -->
        <script src="./js/supabase-booking.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>